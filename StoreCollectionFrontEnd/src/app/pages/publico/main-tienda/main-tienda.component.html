<!-- HERO -->
<section class="hero-minimal">
  <div class="container">
    <div class="row align-items-center gx-5">
      <!-- Texto -->
      <div class="col-lg-6 order-2 order-lg-1" 
           [class.col-lg-12]="!tienda?.logo_img_url"
           data-aos="fade-right">
        <h1 class="hero-title">
          {{ tienda?.nombre || 'Cargando tienda...' }}
          <small class="d-block mt-2 fs-5 fw-normal text-success" *ngIf="tienda?.planNombre">
            Plan {{ tienda.planNombre }}
          </small>
        </h1>
        <p class="hero-subtitle">Bienvenido a tu tienda favorita</p>
        <p class="hero-description">
          {{ tienda?.descripcion || 'Los mejores productos con envíos a todo el país.' }}
        </p>

        <div class="info-chips d-flex flex-wrap gap-3 mt-4 mb-5">
          <div class="info-chip" *ngIf="tienda?.direccion">
            <i class="bi bi-geo-alt-fill"></i> {{ tienda.direccion }}
          </div>
          <div class="info-chip" *ngIf="tienda?.horarios">
            <i class="bi bi-clock-fill"></i> {{ tienda.horarios }}
          </div>
        </div>

        <div class="hero-actions">
          <a routerLink="catalogo" class="btn-explore">
            Explorar Catálogo
          </a>
        </div>
      </div>

      <!-- Imagen - SOLO se muestra si existe logo -->
      <div class="col-lg-6 text-center order-1 order-lg-2 mb-5 mb-lg-0" 
           *ngIf="tienda?.logo_img_url"
           data-aos="fade-left">
        <div class="hero-image-wrapper">
          <img [src]="tienda.logo_img_url"
               alt="{{ tienda?.nombre || 'Tienda' }}"
               class="hero-image"
               loading="lazy">
        </div>
      </div>
    </div>
  </div>
</section>

<!-- CATEGORÍAS POPULARES -->
<section class="section-categories py-5">
  <div class="container position-relative">
    <h2 class="section-title text-center mb-5 fw-bold">
      Categorías populares
    </h2>

    <div *ngIf="categorias.length > 0; else emptyCategories">
      <!-- Flechas de navegación -->
      <button class="nav-arrow nav-left" 
              (click)="scrollCategories('left')" 
              [class.hidden]="!showLeftArrow">
        <i class="bi bi-chevron-left"></i>
      </button>

      <button class="nav-arrow nav-right" 
              (click)="scrollCategories('right')" 
              [class.hidden]="!showRightArrow">
        <i class="bi bi-chevron-right"></i>
      </button>

      <!-- Contenedor del carrusel -->
      <div #categoriesScroller class="categories-scroller" (scroll)="onScroll($event)">
        <div class="categories-track">
          <!-- Cada tarjeta -->
          <a *ngFor="let cat of categorias; let i = index"
             [routerLink]="['catalogo', cat.slug]"
             class="category-card"
             data-aos="fade-up"
             [attr.data-aos-delay]="i * 60">

            <div class="category-icon-circle" [style.backgroundColor]="getColorForCategory(i)">
              <span class="category-initial">
                {{ cat.nombre.charAt(0).toUpperCase() }}
              </span>
            </div>

            <h3 class="category-name mt-3 mb-0">
              {{ cat.nombre }}
            </h3>
          </a>
        </div>
      </div>
    </div>

    <ng-template #emptyCategories>
      <div class="empty-state text-center py-5">
        <i class="bi bi-grid-3x3-gap display-4 text-muted mb-4"></i>
        <h4 class="text-dark fw-semibold">Aún no hay categorías disponibles</h4>
        <p class="text-muted">Pronto agregaremos nuevas categorías</p>
      </div>
    </ng-template>
  </div>
</section>

<!-- PRODUCTOS DESTACADOS -->
<section class="section-featured py-5">
  <div class="container">
    <div class="d-flex justify-content-between align-items-center mb-5 flex-wrap gap-3">
      <h2 class="section-title mb-0">Productos Destacados</h2>
      <a routerLink="catalogo" class="ver-todo">
        Ver todo →
      </a>
    </div>

    <div *ngIf="destacados.length > 0; else emptyProducts" class="row g-4">
      <div class="col-6 col-md-4 col-lg-3" 
           *ngFor="let p of destacados; let i = index"
           data-aos="fade-up"
           [attr.data-aos-delay]="i * 80">
        <app-producto-card [producto]="p"></app-producto-card>
      </div>
    </div>

    <ng-template #emptyProducts>
      <div class="empty-state text-center py-5">
        <i class="bi bi-basket2 display-4 text-muted mb-4"></i>
        <h4 class="text-dark fw-semibold">Pronto habrá productos destacados</h4>
        <p class="text-muted">Estamos preparando lo mejor para ti</p>
        <a routerLink="catalogo" class="btn-explore-small">
          Explorar catálogo
        </a>
      </div>
    </ng-template>
  </div>
</section>

<!-- Loading global -->
<div class="loading-full text-center py-5" *ngIf="loading">
  <div class="spinner-border text-success" style="width: 3.5rem; height: 3.5rem;"></div>
  <p class="mt-4 text-muted fs-5">Cargando tu tienda...</p>
</div>