<!-- category-form.component.html -->
<div class="modal-card shadow-lg rounded-4 overflow-hidden" (click)="$event.stopPropagation()" data-aos="zoom-in">
  <div class="modal-header bg-primary text-white p-4">
    <h2 class="h4 mb-0 fw-bold">
      <i class="bi bi-tags-fill me-3"></i>
      {{ isEdit ? 'Editar Categoría' : 'Crear Nueva Categoría' }}
    </h2>
    <button class="btn-close btn-close-white" (click)="cancel()" [disabled]="loading()"></button>
  </div>

  <div class="modal-body p-4 p-lg-5">
    <form>
      <!-- Nombre -->
      <div class="mb-4">
        <label class="form-label fw-semibold text-dark">
          <i class="bi bi-fonts me-2"></i>Nombre de la categoría
        </label>
        <input
          [(ngModel)]="nombre"
          name="nombre"
          type="text"
          class="form-control form-control-lg rounded-3 shadow-sm"
          placeholder="Ej: Electrónica, Ropa, Hogar..."
          autofocus
          [disabled]="loading()"
        />
      </div>

      <!-- Dropdown de Tiendas SOLO para ADMIN -->
      <div class="mb-4" *ngIf="auth.isAdmin()">
        <label class="form-label fw-semibold text-dark">
          <i class="bi bi-shop me-2"></i>Tienda destino
        </label>
        <select
          [(ngModel)]="tiendaId"
          name="tiendaId"
          class="form-select form-select-lg rounded-3 shadow-sm"
          [disabled]="loading() || tiendas().length === 0"
        >
          <option [ngValue]="null" disabled>
            {{ tiendas().length === 0 ? 'Cargando tiendas...' : 'Seleccionar tienda' }}
          </option>
          <option *ngFor="let tienda of tiendas()" [ngValue]="tienda.id">
            {{ tienda.descripcion }}
          </option>
        </select>
        <small class="text-muted d-block mt-2">
          <i class="bi bi-info-circle me-1"></i>
          Como administrador, debes asignar la categoría a una tienda específica.
        </small>
      </div>

      <!-- Mensaje de error -->
      <div *ngIf="errorMessage()" class="alert alert-danger rounded-3 shadow-sm d-flex align-items-center">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        {{ errorMessage() }}
      </div>

      <!-- Botones -->
      <div class="d-flex gap-3 mt-5">
        <button
          type="button"
          class="btn btn-outline-secondary btn-lg flex-fill rounded-3"
          (click)="cancel()"
          [disabled]="loading()"
        >
          Cancelar
        </button>
        <button
          type="button"
          class="btn btn-primary btn-lg flex-fill rounded-3 shadow"
          (click)="save()"
          [disabled]="loading()"
        >
          <span *ngIf="loading()" class="spinner-border spinner-border-sm me-2"></span>
          <i class="bi bi-check2-circle me-1"></i>
          {{ isEdit ? 'Guardar Cambios' : 'Crear Categoría' }}
        </button>
      </div>
    </form>
  </div>
</div>