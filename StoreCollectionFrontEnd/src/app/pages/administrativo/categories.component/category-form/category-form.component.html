<div class="modal-card shadow-lg rounded-4 overflow-hidden" (click)="$event.stopPropagation()" data-aos="zoom-in">
  <!-- Header -->
  <div class="modal-header bg-gradient-primary text-white p-4 p-md-5 border-0">
    <h2 class="h4 h3-md mb-0 fw-bold d-flex align-items-center gap-3">
      <i class="bi bi-tags-fill fs-3"></i>
      {{ isEdit ? 'Editar Categoría' : 'Crear Nueva Categoría' }}
    </h2>
    <button class="btn-close btn-close-white" (click)="cancel()" [disabled]="loading()"></button>
  </div>

  <!-- Body -->
  <div class="modal-body p-4 p-md-5 bg-white">
    <form>
      <!-- Nombre -->
      <div class="mb-4">
        <label class="form-label fw-semibold text-dark d-flex align-items-center gap-2">
          <i class="bi bi-fonts"></i>
          Nombre de la categoría
          <span class="text-danger ms-1">*</span>
        </label>
        <input
          [(ngModel)]="nombre"
          name="nombre"
          type="text"
          class="form-control"
          placeholder="Ej: Electrónica, Ropa, Hogar..."
          required
          autofocus
          [disabled]="loading()"
        />
      </div>

      <!-- Dropdown de Tiendas (solo ADMIN) -->
      <div class="mb-5" *ngIf="auth.isAdmin()">
        <label class="form-label fw-semibold text-dark d-flex align-items-center gap-2">
          <i class="bi bi-shop"></i>
          Tienda destino
          <span class="text-danger ms-1">*</span>
        </label>
        <select
          [(ngModel)]="tiendaId"
          name="tiendaId"
          class="form-select"
          [disabled]="loading() || tiendas().length === 0"
          required
        >
          <option [ngValue]="null" disabled>
            {{ tiendas().length === 0 ? 'Cargando tiendas...' : 'Selecciona una tienda' }}
          </option>
          <option *ngFor="let tienda of tiendas()" [ngValue]="tienda.id">
            {{ tienda.descripcion }}
          </option>
        </select>
        <small class="text-muted d-block mt-2">
          <i class="bi bi-info-circle me-1"></i>
          Obligatorio para administradores
        </small>
      </div>

      <!-- Mensaje de error -->
      <div *ngIf="errorMessage()" class="alert alert-danger rounded-3 shadow-sm d-flex align-items-center mb-4">
        <i class="bi bi-exclamation-triangle-fill me-2 fs-4"></i>
        {{ errorMessage() }}
      </div>

      <!-- Botones -->
      <div class="d-flex flex-column flex-md-row gap-3 mt-5 pt-4 border-top">
        <button
          type="button"
          class="btn btn-outline-secondary btn-md flex-fill rounded-pill py-2 py-md-3"
          (click)="cancel()"
          [disabled]="loading()"
        >
          Cancelar
        </button>

        <button
          type="button"
          class="btn btn-primary btn-md flex-fill rounded-pill py-2 py-md-3 shadow"
          (click)="save()"
          [disabled]="loading()"
        >
          <span *ngIf="loading()" class="spinner-border spinner-border-sm me-2"></span>
          <i class="bi bi-check2-circle me-1"></i>
          {{ isEdit ? 'Guardar Cambios' : 'Crear Categoría' }}
        </button>
      </div>
    </form>
  </div>
</div>