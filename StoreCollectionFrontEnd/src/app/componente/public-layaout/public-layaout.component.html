<!-- HEADER -->
<header class="public-header" [class.scrolled]="isScrolled">
  <div class="container py-3">
    <div class="d-flex align-items-center justify-content-between">

      <!-- Logo + Nombre -->
      <a [routerLink]="['/', tienda?.slug]" class="d-flex align-items-center text-decoration-none gap-3">
        @if (tienda?.logo_img_url) {
          <div class="logo-container">
            <img [src]="tienda.logo_img_url"
                 [alt]="'Logo de ' + (tienda?.nombre || 'la tienda')"
                 class="logo-img">
          </div>
        }
        <div>
          <h5 class="tienda-nombre mb-0 fw-bold text-dark">{{ tienda?.nombre || 'STORE COLLECTION' }}</h5>
          @if (tienda?.planNombre) {
            <span class="badge bg-success text-white small rounded-pill">{{ tienda.planNombre }}</span>
          }
        </div>
      </a>

      <!-- Navegación Desktop -->
      <nav class="d-none d-lg-flex align-items-center gap-4">
        <a class="nav-link px-4 py-2 rounded-3" 
           [routerLink]="['/', tienda?.slug]" 
           routerLinkActive="active">Inicio</a>
        <a class="nav-link px-4 py-2 rounded-3" 
           [routerLink]="['/', tienda?.slug, 'catalogo']" 
           routerLinkActive="active">Catálogo</a>
        <a class="nav-link px-4 py-2 rounded-3" 
           [routerLink]="['/', tienda?.slug, 'conocenos']" 
           routerLinkActive="active">Conócenos</a>
      </nav>

      <!-- Carrito (siempre visible) -->
      <a [routerLink]="['/', tienda?.slug, 'carrito']"
         class="position-relative text-dark text-decoration-none"
         aria-label="Ver carrito">
        <i class="bi bi-cart3 fs-3"></i>
        @if (totalItemsCarrito > 0) {
          <span class="badge-cart">{{ totalItemsCarrito }}</span>
        }
      </a>

      <!-- Botón menú móvil -->
      <button class="btn btn-outline-dark d-lg-none rounded-circle p-2" 
              (click)="toggleMenu()" 
              aria-label="Abrir menú">
        <i class="bi fs-4" [class.bi-list]="!menuOpen" [class.bi-x-lg]="menuOpen"></i>
      </button>
    </div>
  </div>

  <!-- Menú móvil -->
  <div class="mobile-menu" [class.open]="menuOpen">
    <div class="container py-4">
      <a class="d-block py-3 text-dark border-bottom" 
         [routerLink]="['/', tienda?.slug]" 
         (click)="closeMenu()" 
         routerLinkActive="active fw-bold">Inicio</a>
      <a class="d-block py-3 text-dark border-bottom" 
         [routerLink]="['/', tienda?.slug, 'catalogo']" 
         (click)="closeMenu()" 
         routerLinkActive="active fw-bold">Catálogo</a>
      <a class="d-block py-3 text-dark" 
         [routerLink]="['/', tienda?.slug, 'conocenos']" 
         (click)="closeMenu()" 
         routerLinkActive="active fw-bold">Conócenos</a>
    </div>
  </div>
</header>

<!-- CONTENIDO PRINCIPAL -->
<main class="public-main flex-grow-1">
  <router-outlet></router-outlet>
</main>

<!-- Botones de redes sociales flotantes (abajo a la derecha) -->
<div class="social-floating-container">
 <!-- WhatsApp -->
@if (tienda?.whatsapp && getWhatsAppLink()) {
  <a [href]="getWhatsAppLink()"
     (click)="abrirWhatsApp(); $event.preventDefault()"
     class="social-btn-float whatsapp"
     aria-label="Chatear por WhatsApp">
    <i class="bi bi-whatsapp fs-4"></i>
  </a>
}

<!-- Instagram -->
@if (instagramUrl) {
  <a [href]="instagramUrl"
     target="_blank" rel="noopener noreferrer"
     class="social-btn-float instagram">
    <i class="bi bi-instagram fs-4"></i>
  </a>
}

<!-- TikTok -->
@if (tiktokUrl) {
  <a [href]="tiktokUrl"
     target="_blank" rel="noopener noreferrer"
     class="social-btn-float tiktok">
    <i class="bi bi-tiktok fs-4"></i>
  </a>
}

<!-- Facebook -->
@if (facebookUrl) {
  <a [href]="facebookUrl"
     target="_blank" rel="noopener noreferrer"
     class="social-btn-float facebook">
    <i class="bi bi-facebook fs-4"></i>
  </a>
}
</div>

<!-- FOOTER -->
<footer class="public-footer text-light">
  <div class="container py-5">
    <div class="row g-5">
      <div class="col-lg-4">
        <div class="d-flex align-items-center gap-4 mb-4">
          @if (tienda?.logo_img_url) {
            <div class="footer-logo-container">
              <img [src]="tienda.logo_img_url" [alt]="tienda.nombre" class="footer-logo-img">
            </div>
          }
          <h4 class="fw-bold mb-0">{{ tienda?.nombre || 'STORE COLLECTION' }}</h4>
        </div>
        <p class="text-light-emphasis small">
          {{ tienda?.descripcion || 'Tu tienda online favorita con productos exclusivos y la mejor atención.' }}
        </p>
      </div>

      <div class="col-lg-2 col-md-6">
        <h6 class="fw-bold mb-4">Enlaces</h6>
        <ul class="list-unstyled small">
          <li class="mb-3"><a [routerLink]="['/', tienda?.slug]" class="text-light-emphasis text-decoration-none hover-success">Inicio</a></li>
          <li class="mb-3"><a [routerLink]="['/', tienda?.slug, 'catalogo']" class="text-light-emphasis text-decoration-none hover-success">Catálogo</a></li>
          <li class="mb-3"><a [routerLink]="['/', tienda?.slug, 'conocenos']" class="text-light-emphasis text-decoration-none hover-success">Conócenos</a></li>
        </ul>
      </div>

      <div class="col-lg-3 col-md-6">
        <h6 class="fw-bold mb-4">Contacto</h6>
        <ul class="list-unstyled small">
          @if (tienda?.direccion) {
            <li class="mb-3 d-flex gap-3"><i class="bi bi-geo-alt-fill text-success"></i> {{ tienda.direccion }}</li>
          }
          @if (tienda?.horarios) {
            <li class="mb-3 d-flex gap-3"><i class="bi bi-clock-fill text-success"></i> {{ tienda.horarios }}</li>
          }
          @if (tienda?.whatsapp) {
            <li class="mb-3 d-flex gap-3"><i class="bi bi-whatsapp text-success"></i> {{ tienda.whatsapp }}</li>
          }
        </ul>
      </div>

      <div class="col-lg-3">
        <h6 class="fw-bold mb-4">Síguenos</h6>
        @if (socialLinks.length > 0) {
          <div class="d-flex gap-3 mb-4 flex-wrap">
            @for (social of socialLinks; track social.platform) {
              <a [href]="social.url" 
                 target="_blank" 
                 rel="noopener noreferrer"
                 class="social-btn"
                 [attr.aria-label]="'Seguir en ' + social.platform">
                <i [class]="social.icon + ' fs-5'"></i>
              </a>
            }
          </div>
        } @else {
          <p class="text-light-emphasis small fst-italic">
            Síguenos pronto en nuestras redes
          </p>
        }
      </div>
    </div>

    <hr class="border-secondary my-5">

    <div class="text-center small text-light-emphasis">
      <p class="mb-2">© {{ currentYear }} <strong>{{ tienda?.nombre || 'STORE COLLECTION' }}</strong> • Todos los derechos reservados</p>
      <p class="mb-0 opacity-75">Hecho con <i class="bi bi-heart-fill text-danger"></i> en Perú</p>
    </div>
  </div>
</footer>